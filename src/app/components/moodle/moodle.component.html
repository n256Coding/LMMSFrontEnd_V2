<!-- main -->
<div class="container main-view">
  <!-- start card -->
    <div class="card">
        <div class="card-header">
            <h3>Moodle Page and Question files validation Service</h3>
        </div>
        <div class="card-body"> <!--start card body-->
          <p class="card-title" *ngIf="checkValue === 'moodle_page_view' "> You can check your moodle page with our predifined 
            standards. Any login credential details are not saved in our server. Credentials are removed after validation process finished !! </p>
          <p class="card-title" *ngIf="checkValue === 'quiz_file_view' ">Get an analized report of your moodle quiz files. File format should be in Moodle xml formats only.</p>
          <!-- <p class="card-text">These standards are predefined ones and Also you can customize the validation selections.</p> -->
          <div class="row" style="margin-top: 20px"> <!--start moodle section-->
              <div class="col-sm-12 col-xs-12">
                  <form>
                    <div class="form-group">
                      <select class="form-control" id="selectOption" (change)="selectedOption($event)">
                        <option value="default">Select validation option</option>
                        <option value="moodle_page_view" >Moodle Page Validation</option>
                        <option value="quiz_file_view">Moodle Question File Validation</option>
                      </select>
                    </div>
                  </form>
              </div> 
          </div><!--start moodle section-->
          <!-- Moodle page validator row -->
  <div class="row" *ngIf="checkValue === 'moodle_page_view' ">
      <div class="col-sm-12 col-xs-12">
          <form id="moodle-page-validator" #moodle="ngForm" (ngSubmit)="startMoodlePageValidation(pageUrl)">
            <h4>Moodle Page Validator</h4>
            <div class="form-group">
              <label for="moodle_course_url">Moodle Course Page URL</label>
              <input [(ngModel)]="m_pageUrl" name="m_pageUrl" #pageUrl="ngModel" type="url" class="form-control" id="moodle_course_url" pattern="(http:\/\/|https:\/\/).*" placeholder="http://example.com/course/view.php" required>
              <div  *ngIf="pageUrl?.touched && pageUrl.errors?.required" class="invalid-message">
                Moodle page URL required !!!
              </div>
              <div  *ngIf="pageUrl.errors?.pattern" class="invalid-message">
                Invalid page URL !!!
              </div>
            </div>
            <p style="color: green">
              <button type="button" id="btn_enter_cred" class="badge badge-success" (click)="enterLoginCreds()">Enter Login Credentials</button> 
              <button type="button" id="btn_cancel_cred" class="badge badge-success dis-none" (click)="cancelLoginCreds()">Cancel Login Credentials</button>
              Click If you required to fill your moodle login Credentials. <i class="fa fa-info-circle" (click)="credInfo()"></i></p> 
            <div class="border-style-1 margin-bottom-10" *ngIf="btnNeedsCredentials === 'needs_cred' ">
                 <!-- start  -->
                <div class="form-group">
                    <label for="moodle_login_url">Moodle Login URL</label>
                    <input [(ngModel)]="m_loginUrl" name="m_loginUrl" #loginUrl="ngModel" type="url" class="form-control" id="moodle_login_url" pattern="(http:\/\/|https:\/\/).*" placeholder="http://example.com/login.php" required>
                    <div  *ngIf="loginUrl?.touched && loginUrl.errors?.required" class="invalid-message">
                      Moodle site's login URL required !!!
                    </div>
                    <div  *ngIf="loginUrl.errors?.pattern" class="invalid-message">
                      Invalid login URL !!!
                    </div>
                  </div>           
                    <div class="form-group">
                      <label for="moodle_login_username">User Name</label>
                      <input [(ngModel)]="m_username" name="m_username" #userName="ngModel" type="text"  class="form-control" id="moodle_login_username"  placeholder="user" required>                      
                      <div  *ngIf="userName?.touched && userName.errors?.required" class="invalid-message">
                        Moodle site's username required !!!
                      </div>
                    </div>   
                    <div class="form-group">
                      <label for="moodle_login_pwd">Password</label>
                      <input [(ngModel)]="m_pwd" name="m_pwd" #userPwd="ngModel" type="password" class="form-control" id="moodle_login_pwd" placeholder="Password" required>
                      <div  *ngIf="userPwd?.touched && userPwd.errors?.required" class="invalid-message">
                        Moodle site's password required !!!
                      </div>      
                    </div>
                    <!-- end -->
            </div>
            
              <!-- <small id="emailHelp" class="form-text text-muted">Only for Login</small> -->
              
              <!-- validation type selection div --> 
              <div class="border-style-1">
                <div class="form-group">
                    <label for="standardType">select Validation Type</label>
                    <select class="form-control" id="standardType" (change)="selectedMoodleStandard($event)">
                      <option value="moodle_standard_validation">Standard Validation</option>
                      <option value="moodle_custom_validation">Custom Validation</option>
                    </select>
                    <small id="emailHelp" class="form-text text-muted">
                      more about standard types<i id="standardInfoIcon" class="fa fa-info-circle margin-left-10"></i>
                    </small>
                </div>
                 <!-- moodle settings  -->
                <div>
                  <hr>
                    <div class="moodle-div-style" *ngIf="standardType === 'moodle_custom_validation' ">
                      <h4>Custom Validation Settings<hr></h4>
                      <p><b>Resource Names Structure</b></p>
                      <div class="form-row">
                          <div class="form-group col-md-6">
                            <label for="inputBeginString" >Begining String</label>
                            <input [(ngModel)]="begin_string" name="begin_string" #beginString="ngModel" type="text" class="form-control" id="inputBeginString" required>
                            <div *ngIf="beginString?.touched && beginString.errors?.required" class="invalid-message">
                              Begining String is required !!!
                            </div> 
                          </div>
                          <div class="form-group col-md-3">
                            <label for="inputState">Number</label>
                            <select id="inputState" class="form-control" (change)="selectResNumType($event)">
                              <option value="numAdd">added</option>
                              <option value="numNotAdd">not added</option>
                            </select>
                          </div>
                          <div class="form-group col-md-3">
                            <label for="inputChar">Characters</label>
                            <select id="inputState" class="form-control" (change)="selectResCharType($event)">
                              <option value="none">none</option>  
                              <option value=":">:</option>
                              <option value="-">-</option>
                              <option value="=">=</option>
                              <option value=";">;</option>
                              <option value="()">()</option>
                              <option value="[]">[]</option>
                              <!-- <option value="">{}</option> -->     
                            </select>
                          </div>
                          <p><span class="badge badge-info margin-left-10" (click)="showPreviewRes()">Preview</span></p>
                          <p><span id="showResourcePreview"class="margin-left-10" style="color: forestgreen"></span>
                          <i id="clsResPrew" class="fa fa-close margin-left-5 dis-none" (click)="closePreviewRes()" style="color: firebrick"></i></p>
                        </div>
                      <div class="form-group row">
                        <label for="weekly_lesson_type" class="col-sm-9 col-xs-9 col-form-label">Weekly Lesson Type</label>
                        <div class="col-sm-3 col-xs-3">
                          <select id="weekly_lesson_type" class="form-control" (change)="getTopicType($event)">
                            <option value="date_wise">Date wise (ex:- 1 January - 7 January)</option>
                            <option value="topic_wise">Topic wise (ex:- Java Development)</option>
                          </select>
                        </div>
                      </div>
                      <div class="form-group row">
                          <label for="weekly_main_desc" class="col-sm-9 col-xs-9 col-form-label">Check main Weekly Description</label>
                          <div class="col-sm-3 col-xs-3">
                            <select id="weekly_main_desc" class="form-control" (change)="getMainDescCheck($event)">
                              <option value="checked">Yes</option>
                              <option value="not_checked">No</option>
                            </select>
                          </div>
                        </div>
                        <div class="form-group row">
                            <label for="check_resource_name" class="col-sm-9 col-xs-9 col-form-label">Check resource's naming convension</label>
                            <div class="col-sm-3 col-xs-3">
                              <select id="check_resource_name" class="form-control" (change)="getResCheck($event)">
                                <option value="checked">Yes</option>
                                <option value="not_checked">No</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-group row">
                              <label for="check_resource_desc" class="col-sm-9 col-xs-9 col-form-label">Check resources description</label>
                              <div class="col-sm-3 col-xs-3">
                                <select id="check_resource_desc" class="form-control" (change)="getResDescCheck($event)">
                                  <option value="checked">Yes</option>
                                  <option value="not_cheked">No</option>
                                </select>
                              </div>
                            </div>
                    </div>
                </div>
                <!-- end moodle settings -->
              </div>
              <!-- end validation type selection div -->
              <button type="submit" class="btn btn-primary margin-top-10" [disabled]="moodle.invalid">Submit & Analyze</button>
              <!-- <small id="emailHelp" class="form-text text-muted">Credintials are not saving</small> -->
              <!-- <button id="test" type="button" class="btn btn-primary margin-top-10" (click)="sendMoodleCredentials()">Submit</button> -->
              <!-- <button type="button" class="btn btn-success margin-top-10 margin-left-10" (click)="displayMoodleResults()" >Start Analyze</button> -->
            </form>
      </div>
    </div>
    <!-- //moodle page validaton row -->
        <!-- question file analyzer row -->
    <div class="row" *ngIf="checkValue === 'quiz_file_view' ">
      <div class="col-sm-12 col-xs-12">
          <h4>Moodle Question File Analyzer</h4>
          <div id="question-file-validator" class="row">
            <div class="col-md-9 col-sm-9 col-xs-12 file-uploader-style">
              <input type="file" class="form-control-file" id="exampleFormControlFile1" (change)="selectFile($event)">
            </div>
            <div class="col-md-3 col-sm-3 col-xs-12 ">
              <button class="btn btn-primary  margin-left-10" [disabled]="!selectedFiles" (click)="upload()">Upload</button>
            </div>
            <div class="col-sm-12 col-xs-12 ">
                <div *ngIf="currentFileUpload" class="progress progress-bar-height">
                  <div class="progress progress-bar progress-bar-striped progress-bar-animated"
                    role="progressbar" attr.aria-valuenow="{{progress.percentage}}"
                    aria-valuemin="0" aria-valuemax="100"
                    [ngStyle]="{width:progress.percentage+'%'}">
                    </div>
                </div>
            </div>
      </div>
  
      <!-- question settings -->
      <div class="col-md-12 col-md-12 col-xs-12 ">
        <hr>
          <div class="quiz-div-style">
            <h4>Question Analyzing Settings<hr></h4>
            <div class="form-group">
                <label for="quizStdType">Analyze Option</label>
                <select class="form-control" id="quizStdType" (change)="selectedQuizStd($event)">
                  <option value="basic_quiz_analyze" selected>Basic Analyze</option>
                  <option value="custom_quiz_analyze">Custom Analyze</option>
                </select>
            </div>
            <!-- settings -->
            <div *ngIf="quizStdType === 'custom_quiz_analyze' ">
              <div class="form-group row">
                <label for="mcq_type" class="col-md-9 col-sm-9 col-xs-9 col-form-label">MCQ Question Type</label>
                <div class="col-md-3 col-sm-3 col-xs-3">
                  <select id="mcq_type" class="form-control">
                    <option selected>Single Answers</option>
                    <option>Multiple Answers</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="question_amount" class="col-md-9 col-sm-9 col-xs-9 col-form-label">Check no of questions</label>
                <div class="col-md-3 col-sm-3 col-xs-3">
                  <select id="question_amount" class="form-control">
                    <option selected>Yes</option>
                    <option>No</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="check_resource_name" class="col-md-9 col-sm-9 col-xs-9 col-form-label">Check no of answers (MCQ only)</label>
                <div class="col-md-3 col-sm-3 col-xs-3">
                  <select id="check_resource_name" class="form-control">
                    <option selected>Yes</option>
                    <option>No</option>
                  </select>
                </div>
              </div>
              <div class="form-group row">
                <label for="check_resource_desc" class="col-md-9 col-sm-9 col-xs-9 col-form-label">No of Answers for each MCQ question</label>
                <div class="col-md-3 col-sm-3 col-xs-3">
                  <select id="check_resource_desc" class="form-control">
                    <option selected>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                    <option>7</option>
                  </select>
                </div>
               </div>
              </div>
                <!-- settings ends-->
                <div class="form-group row">
                      <div class="col-md-12 col-sm-12 col-xs-12">
                        <!-- <button type="button" class="btn btn-primary margin-right-10" (click)="checkMe()">Apply Settings</button> -->
                        <button type="button" class="btn btn-primary" (click)="startQuizAnalyze()">Start Analyze</button>
                      </div>
                </div>
              </div>
          </div><!-- question settings end -->
        </div><!-- //question file analyzer row -->  
      </div> <!--end start card body-->
    </div>
    <!--end start card -->
  
</div>
<!-- //main -->

<!-- Moodle Loading Modal -->
<div class="modal fade" id="moodleLoadingModal" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm" role="document">
    <div class="modal-content">
      <div class="modal-body">
          <div class="text-center">
              <img src="../../../assets/moodle-images/loading-2.gif" width="250px" height="250px">
          </div>
      </div>
    </div>
  </div>
</div>
<!-- Moodle Loading Modal Ends -->